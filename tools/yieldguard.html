<style>
    .tool-wrapper { background: var(--bg-card); border-radius: 16px; padding: 24px; border: 1px solid var(--border); }
    .yield-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
    
    .input-section { background: var(--bg-site); padding: 20px; border-radius: 12px; border: 1px solid var(--border); }
    .input-group { margin-bottom: 15px; }
    .input-group label { display: block; font-size: 11px; font-weight: 700; color: var(--text-muted); text-transform: uppercase; margin-bottom: 5px; }
    .input-group input { width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 6px; font-weight: 600; }

    .result-section { display: flex; flex-direction: column; justify-content: center; }
    .yield-card { 
        background: var(--primary); color: white; padding: 30px; border-radius: 20px; text-align: center;
        box-shadow: 0 15px 30px rgba(15, 23, 42, 0.2);
    }
    .yield-card h4 { margin: 0; font-size: 14px; color: rgba(255,255,255,0.6); text-transform: uppercase; }
    .yield-card .price { font-size: 48px; font-weight: 800; margin: 10px 0; color: var(--success); }
    .yield-card .savings { font-size: 13px; background: rgba(255,255,255,0.1); padding: 5px 12px; border-radius: 20px; }

    .analysis-box { margin-top: 20px; border-top: 1px solid var(--border); padding-top: 20px; }
    .analysis-item { display: flex; justify-content: space-between; font-size: 13px; margin-bottom: 8px; }
    .analysis-item b { color: var(--primary); }
</style>

<div class="tool-wrapper">
    <div class="yield-grid">
        <div class="input-section">
            <h3 style="margin-top:0; font-size:18px;">Gap Analysis</h3>
            <div class="input-group">
                <label>Standard Nightly Rate ($)</label>
                <input type="number" id="baseRate" value="150" oninput="calculateYield()">
            </div>
            <div class="input-group">
                <label>Gap Duration (Nights)</label>
                <input type="number" id="gapNights" value="2" oninput="calculateYield()">
            </div>
            <div class="input-group">
                <label>Cleaning Fee ($)</label>
                <input type="number" id="cleaningFee" value="50" oninput="calculateYield()">
            </div>
            <div class="input-group">
                <label>Days Until Gap Starts</label>
                <input type="number" id="daysAway" value="3" oninput="calculateYield()">
            </div>
        </div>

        <div class="result-section">
            <div class="yield-card">
                <h4>Recommended "Flash" Rate</h4>
                <div class="price" id="flashRate">$0</div>
                <div class="savings">Targeting <span id="occupancyBoost">0</span>% Occupancy Boost</div>
            </div>

            <div class="analysis-box">
                <div class="analysis-item">
                    <span>Total Potential Revenue:</span>
                    <b id="totalRev">$0</b>
                </div>
                <div class="analysis-item">
                    <span>Suggested Discount:</span>
                    <b id="discountPerc" style="color:var(--success);">0%</b>
                </div>
                <div class="analysis-item">
                    <span>Strategy:</span>
                    <b id="strategyText" style="color:var(--accent);">Standard</b>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function calculateYield() {
        const base = parseFloat(document.getElementById('baseRate').value) || 0;
        const nights = parseFloat(document.getElementById('gapNights').value) || 0;
        const clean = parseFloat(document.getElementById('cleaningFee').value) || 0;
        const daysAway = parseFloat(document.getElementById('daysAway').value) || 0;

        // Logic: The closer the gap is, the deeper the discount to liquidate the dates
        let discount = 0.10; // Base 10% discount for gaps
        if (daysAway < 7) discount = 0.20;
        if (daysAway < 3) discount = 0.35;
        if (nights === 1) discount += 0.10; // Extra discount for awkward 1-night gaps

        const suggestedNightly = base * (1 - discount);
        const total = (suggestedNightly * nights) + clean;

        document.getElementById('flashRate').innerText = '$' + Math.round(suggestedNightly);
        document.getElementById('totalRev').innerText = '$' + Math.round(total);
        document.getElementById('discountPerc').innerText = Math.round(discount * 100) + '% OFF';
        document.getElementById('occupancyBoost').innerText = Math.round(discount * 250);

        let strategy = "Aggressive Liquidate";
        if (daysAway > 7) strategy = "Early Bird Fill";
        if (daysAway > 14) strategy = "Price Protection";
        document.getElementById('strategyText').innerText = strategy;
    }

    // Run once on load
    calculateYield();
</script>
